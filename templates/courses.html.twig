{#

/* -------------------------

Title: node--courses.html.twig
Descr: outputs twig content from courses json parser for full courses view

--------------------------- */

#}
{# add fancybox #}
{{attach_library('discovery/fancybox')}}

{# set variables for json parser #}
{% set courses_shown = '' %}
{% set list_order = '' %}
{# prefixes from theme settings #}
{% set keyword_params = department_prefix|split(',') %}
{# prefixes from module settings #}
{% set keyword_params = course_prefixes|split(',') %}
{% set semstertext = semestername[semester] %}

{# set classes for the container #}
{%
  set blockClasses = [
    'courses',
    'main',
    view_mode ? 'courses--' ~ view_mode|clean_class,

  ]
%}

<main{{attributes.addClass(blockClasses)}}>
  {{title_suffix}}
  <div class="title">
    {% include "@content/atoms/_heading.twig" with {
    "heading_level" : 1,
    "heading" : 'Courses',
    "heading_base_class" : "title"
  } %}
  </div>

  <div class="content">
    <ul class='inlineList'>
      <span>Courses by semester: </span>
        {% for key,value in semestername %}
          <li><a href='/courses/{{ key }}'>{{ value }}</a></li>
        {% endfor %}
    </ul>
    <h3>
      Courses for {{semstertext}}
    </h3>
    <table id="courses--table" class="courses--table">
      <thead>
        <tr>
          <th>Course ID</th>
          <th>Title</th>
          <th>Offered</th>
        </tr>
      </thead>
      <tbody>
      {# added as twig function #}
      {% for keyword_param in keyword_params %}
        {% set courses = parse_courses_json(semester,keyword_param,courses_shown,list_order) %}
          {% for course in courses %}
            <tr class="course course--table-row">
              <td class="course__number">
                {{course.subject}}{{course.number}}
              </td>
              <td class="course__content">
              <span class="course__title">{{course.title}}<button class="toggle toggle--course-detail course__show-more">Show more</button></span>
              <span class="course__description">
                {{course.description}}
                <p><a href="https://classes.cornell.edu/browse/roster/{{semester}}/class/{{course.subject}}/{{course.number}}">
              Full details for
              {{course.subject}}
              {{course.number}}
              -
              {{course.title}}</a></p>
              </span>
              </td>
              <td class="course__offered">
                {{course.offered}}
              </td>
            </tr>
          {% endfor %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</main>
